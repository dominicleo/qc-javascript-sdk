!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e=e||self).JSSDK={})}(this,function(e){"use strict";var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,n)};var n=function(){return(n=Object.assign||function(e){for(var t,n=1,r=arguments.length;r>n;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},r="undefined"!=typeof window;function o(e){return e instanceof Function}function i(e){if("object"!=typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}var c=function(e){function n(t,n){var r=e.call(this,t)||this;return r.code=null,r.name="SDKError",r.message=t,n&&(r.code=n),r}return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}(n,e),n}(Error);function a(e){if(i(e))return e;try{return JSON.parse(e)}catch(e){return{}}}var s={debug:!1,timeout:1e4,timeoutExclude:["Moxiecert","watchShake","jump","faceplusplus","getAccessToken","registerCallback","resumeEvent","uploadImage","getWldData"],responseSuccessCode:0},u=function(){if(!r)return!1;var e=!!(window&&window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.QCJSInterface&&window.webkit.messageHandlers.QCJSInterface.postMessage)&&window.webkit.messageHandlers.QCJSInterface.postMessage;if(o(e))return function(t){e(JSON.parse(JSON.stringify(t)))};var t=!!(window&&window.QCJSInterface&&window.QCJSInterface.callApp)&&window.QCJSInterface.callApp;return!!o(t)&&function(e){t(JSON.stringify(e))}}(),f=function(){function e(e){this.id=1,this.options=Object.assign(s,e)}return e.prototype.callbackid=function(e){return["JSBridge",e,+new Date,++this.id].join("_")},e.prototype.call=function(t,n){var r=this,s=this.options,f=s.responseSuccessCode,l=s.timeout,d=s.timeoutExclude,p=void 0===d?[]:d,w=s.transformRequest;return t?n&&!i(n)?Promise.reject(new c("请确认 JSSDK 参数类型",100006)):o(u)?new Promise(function(i,s){var d=r.callbackid(t),S={method:t,params:n,callback:d},m=(n||{}).callback;p.includes(t)||(e.timer[d]=setTimeout(function(){return o(e.cache[d])&&delete e.cache[d],s(new c("JSSDK %s 响应超时".replace("%s",t),100004))},l)),e.cache[d]=function(t){var n=a(t);return e.timer[d]&&clearTimeout(e.timer[d]),o(m)&&m(n),(n.code===f?i:s)(n)},o(w)&&(S.params=w(S.params,t)),u(S)}):Promise.reject(new c("JSBridge 不受支持.",100005)):Promise.reject(new c("请确认 JSSDK 名称.",100003))},e.track=function(t,n){return new e({}).call(t,n)},e.prototype.logger=function(e){var t=(new Date).toTimeString().replace(/.*(\d{2}:\d{2}:\d{2}).*/,"$1");this.options.debug&&console.log("JSSDK ["+t+"]",e)},e.appCallback=function(t){var r=a(t),i=r.data,c=e.cache[r.callbackid];o(c)&&c(n({},i))},e.cache={},e.timer={},e}();r&&(window.QCJSAPI||(window.QCJSAPI=f),window.QCJSSDK||(window.QCJSSDK=f)),e.SDKError=c,e.default=f,Object.defineProperty(e,"__esModule",{value:!0})});
